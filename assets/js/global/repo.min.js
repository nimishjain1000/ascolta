function getLocation(t){var e=document.createElement("a");return e.href=t,e}function renderPage(t,e){var n=Math.random().toString(36).substr(2,5);$("html").attr("data-get-id",n),NProgress.start(),e=e||{},pathname=getLocation(e.pathname||t),title=(e.title||"Welcome to Ascolta")+" | Ascolta",logHistory="undefined"==typeof e.logHistory?!0:e.logHistory,logHistory?(history.pushState({title:e.title||"Welcome to Ascolta"},title,pathname.pathname+pathname.search),$("title").text(title)):"undefined"!=typeof e.title&&$("title").text(title),spin="undefined"==typeof e.spin?!0:e.spin,contentid=e.contentid||"#main-content",spin&&$(contentid).html(spinning),successCallback=e.successCallback||successPage,failureCallback=e.failureCallback||errorPage,$.get(t,function(t){$("html").attr("data-get-id")==n&&successCallback(t,contentid),NProgress.done()}).fail(function(t,e){var o="";o=0===t.status?"No Internet Connection.":404==t.status?"Couldn't find the page.":500==t.status?"We messed up. Internal Server Error.":"parsererror"===e?"Couldn't make sense of the data we recieved.":"timeout"===e?"We only have so much time. Request timed out.":"abort"===e?"Abort! Abort! Mission Aborted! Page request aborted!":"Uncaught Error."+t.responseText,$("html").attr("data-get-id")==n&&failureCallback('<div class="alert alert-danger"><p class="lead text-center"><b>Oops!</b> - '+o+"</p></div>",contentid),NProgress.done()})}function successPage(t,e){e=e||"#main-content",$(e).html(t)}function errorPage(t,e){e=e||"#main-content",$(e).html('<div class="box-container"><div class="contain-top main-container">'+t+"</div></div>")}function getCookie(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""}function notify(t,e,n){if(Notification)if("granted"!==Notification.permission)Notification.requestPermission();else{var o=new Notification(t,{icon:"http://s2.googleusercontent.com/s2/favicons?domain=monkfromearth.com",body:e});o.onclick=function(){window.open(n)}}}var spinning='<div class="box-container"><div class="main-container contain-top text-center"><i class="fa fa-spin fa-circle-o-notch fa-fw fa-2x"></i></div></div>';$(window).on("popstate",function(){renderPage(location.href,{title:null!=history.state?history.state.title:"Welcome to Ascolta"})}),document.addEventListener("DOMContentLoaded",function(){"granted"!==Notification.permission&&Notification.requestPermission()}),$.get("/assets/js/global/countries.json",function(t){$.get("/ajax/get_location",function(e){var n;for(i in t){t[i].code==e.selected.countryCode&&(n=i);var o=new Option(t[i].name,t[i].name+"|"+t[i].code);$(o).html(t[i].name),$("#changeLocationModal-dropdown").append(o)}$("#changeLocationModal-dropdown>option:eq("+n+")").prop("selected",!0)}).fail(function(){for(i in t){var e=new Option(t[i].name,t[i].name+"|"+t[i].code);$(e).html(t[i].name),$("#changeLocationModal-dropdown").append(e)}})}),$(document).on("change","#changeLocationModal-dropdown",function(){var t=$("#changeLocationModal-dropdown :selected").val();$.get("/ajax/change_location?region="+t,function(t){t.status?($("#changeLocationModal .announce").html('<div class="alert alert-success">Location changed succesfully!</div>'),$("#footer-countryName").html($("#changeLocationModal-dropdown :selected").text())):$("#changeLocationModal .announce").html('<div class="alert alert-danger">Sorry, couldn\'t change the location!</div>')}),setTimeout(function(){$("#changeLocationModal").modal("hide")},1e3)}),$(document).on("click","footer .no-js-link",function(t){t.preventDefault(),renderPage($(this).attr("href"))}),$(document).on("click","#changeLocation",function(t){t.preventDefault(),$("#changeLocationModal").modal("show")});