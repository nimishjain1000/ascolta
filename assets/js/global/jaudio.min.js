!function(t){function i(i,a){this.settings=t.extend(!0,e,a),this.$context=i,this.domAudio=this.$context.find("audio")[0],this.$domPlaylist=this.$context.find(".jAudio--playlist"),this.$domControls=this.$context.find(".jAudio--controls"),this.$domVolumeBar=this.$context.find(".jAudio--volume"),this.$domDetails=this.$context.find(".jAudio--details"),this.$domStatusBar=this.$context.find(".jAudio--status-bar"),this.$domProgressBar=this.$context.find(".jAudio--progress-bar-wrapper"),this.$domTime=this.$context.find(".jAudio--time"),this.$domElapsedTime=this.$context.find(".jAudio--time-elapsed"),this.$domTotalTime=this.$context.find(".jAudio--time-total"),this.$domThumb=this.$context.find(".jAudio--thumb"),this.currentState="pause",this.currentTrack=this.settings.defaultTrack,this.currentElapsedTime=void 0,this.timer=void 0,this.init()}var a="jAudio",e={defaultAlbum:void 0,defaultArtist:void 0,defaultTrack:0};i.prototype={init:function(){var t=this;t.renderPlaylist(),t.preLoadTrack(),t.highlightTrack(),t.updateTotalTime(),t.events(),t.domAudio.volume=1,window.jAudioCore=t},play:function(t){var i=this;i.domAudio.play(),"play"!==i.currentState&&(clearInterval(i.timer),i.timer=setInterval(i.run.bind(i),50),i.currentState="play",t.data("action","pause"),t.html('<i class="fa fa-fw fa-pause"></i>'))},pause:function(t){var i=this;i.domAudio.pause(),clearInterval(i.timer),i.currentState="pause",t.data("action","play"),t.html('<i class="fa fa-fw fa-play"></i>')},stop:function(t){var i=this;i.domAudio.pause(),i.domAudio.currentTime=0,i.animateProgressBarPosition(),clearInterval(i.timer),i.updateElapsedTime(),i.currentState="stop"},prev:function(t){var i,a=this;i=0===a.currentTrack?window.playlist.length-1:a.currentTrack-1,a.changeTrack(i)},next:function(t){var i,a=this;i=a.currentTrack===window.playlist.length-1?0:a.currentTrack+1,a.changeTrack(i)},preLoadTrack:function(){var t=this,i=t.settings.defaultTrack;t.changeTrack(i),t.stop()},changeTrack:function(t){var i=this;i.currentTrack=t,i.domAudio.src=window.playlist[t].file,"play"===i.currentState&&i.play(),i.highlightTrack(),i.updateThumb(),i.renderDetails()},events:function(){var i=this;i.$domControls.on("click",".jAudio--control",function(){var a=t(this),e=a.data("action");switch(e){case"prev":i.prev.call(i,a);break;case"next":i.next.call(i,a);break;case"pause":i.pause.call(i,a);break;case"stop":i.stop.call(i,a);break;case"play":i.play.call(i,a)}}),i.$domPlaylist.on("click",".jAudio--playlist-item",function(a){var e=t(this),r=(e.data("track"),e.index());i.currentTrack!==r&&i.changeTrack(r)}),i.$domProgressBar.on("click",function(t){i.updateProgressBar(t),i.updateElapsedTime()}),t(i.domAudio).on("loadedmetadata",function(){i.animateProgressBarPosition.call(i),i.updateElapsedTime.call(i),i.updateTotalTime.call(i)})},getAudioSeconds:function(t){var i=this,t=t%60;return t=i.addZero(Math.floor(t),2),t=60>t?t:"00"},getAudioMinutes:function(t){var i=this,t=t/60;return t=i.addZero(Math.floor(t),2),t=60>t?t:"00"},addZero:function(t,i){for(var t=String(t);t.length<i;)t="0"+t;return t},removeZero:function(t,i){for(var t=String(t),a=0;i>a&&"0"===t[0];)t=t.substr(1,t.length),a++;return t},highlightTrack:function(){var t=this,i=t.$domPlaylist.children(),a="active";i.removeClass(a),i.eq(t.currentTrack).addClass(a)},renderDetails:function(){var t=this,i=window.playlist[t.currentTrack],a=(i.file,i.thumb,i.trackName),e=i.trackArtist,r=i.id,o="";o+="<p>",o+="<span id='currentTrack' data-id='"+r+"' data-title='"+a+"' data-artist='"+e+"'>"+a+"</span>",o+="<span>"+e+"</span>",o+="</p>",t.$domDetails.html(o)},renderPlaylist:function(){var i=this,a="";t.each(window.playlist,function(t,i){var e=i.file,r=i.thumb,o=i.trackName,n=i.trackArtist,s=i.id;a+="<div class='jAudio--playlist-item' data-track='"+e+"' data-id='"+s+"'>",a+="<div class='jAudio--playlist-thumb'><img src='"+r+"'></div>",a+="<div class='jAudio--playlist-meta'>",a+="<p class='jAudio--playlist-meta-track-name'>"+o.substring(0,48)+" ...</p>",a+="<p class='jAudio--playlist-meta-track-artist'>"+n+"</p>",a+="</div>",a+="</div>"}),i.$domPlaylist.html(a)},run:function(){var t=this;t.animateProgressBarPosition(),t.updateElapsedTime(),t.domAudio.ended&&t.next()},animateProgressBarPosition:function(){var t=this,i=100*t.domAudio.currentTime/window.playlist[t.currentTrack].trackSeconds,a={width:i+"%"};t.$domProgressBar.children().eq(0).css(a)},updateProgressBar:function(t){var i,a,e,r=this;t.offsetX&&(i=t.offsetX),void 0===i&&t.layerX&&(i=t.layerX),a=i/r.$domProgressBar.width(),e=window.playlist[r.currentTrack].trackSeconds*a,r.domAudio.currentTime=e,r.animateProgressBarPosition()},updateElapsedTime:function(){var t=this,i=t.domAudio.currentTime,a=t.getAudioMinutes(i),e=t.getAudioSeconds(i),r=a+":"+e;t.$domElapsedTime.text(r)},updateTotalTime:function(){var t=this;t.$domTotalTime.text(window.playlist[t.currentTrack].trackDuration)},updateThumb:function(){var t=this,i=window.playlist[t.currentTrack].thumb,a={"background-image":"url("+i+")"};t.$domThumb.css(a)}},t.fn[a]=function(a){var e=function(){return new i(t(this),a)};t(this).each(e)}}(jQuery);